<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ä¹ æˆé•¿è®¡åˆ’</title>
    <style>
        :root {
            --primary-color: #7fc97f;
            --secondary-color: #a8dadc;
            --accent-color: #d3e6d2;
            --highlight-color: #f9c507;
            --background-color: #f8fffe;
            --text-color: #2c3e50;
            --text-light: #5a6c7d;
            --success-color: #51cf66;
            --warning-color: #ff6b6b;
            --shadow: 0 5px 15px rgba(127, 201, 127, 0.2);
        }

        [data-theme="spring"] {
            --primary-color: #7fc97f;
            --secondary-color: #a8dadc;
            --accent-color: #d3e6d2;
            --highlight-color: #f9c507;
            --background-color: #f8fffe;
        }

        [data-theme="blossom"] {
            --primary-color: #e91e63;
            --secondary-color: #f8bbd9;
            --accent-color: #f0b5d5;
            --highlight-color: #ea84a3;
            --background-color: #fefbfc;
        }

        [data-theme="lavender"] {
            --primary-color: #8e44ad;
            --secondary-color: #d8b3e0;
            --accent-color: #af8fd0;
            --highlight-color: #f39c12;
            --background-color: #faf9fe;
        }

        [data-theme="sunset"] {
            --primary-color: #e67e22;
            --secondary-color: #ffd275;
            --accent-color: #f9d580;
            --highlight-color: #3498db;
            --background-color: #fffcf8;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: "Microsoft YaHei", "PingFang SC", sans-serif;
            background: linear-gradient(135deg, var(--background-color) 0%, var(--accent-color) 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-color);
            transition: all 0.5s ease;
            font-size: 16px;
            line-height: 1.6;
        }

        .signature {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            color: var(--text-color);
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 1em;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            z-index: 999;
            backdrop-filter: blur(10px);
        }

        .save-buttons {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .save-btn {
            background: var(--success-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .load-btn {
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .load-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .auto-save-indicator {
            position: fixed;
            top: 80px;
            left: 20px;
            background: var(--success-color);
            color: white;
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 1em;
            z-index: 999;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .auto-save-indicator.show {
            opacity: 1;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            transition: all 0.5s ease;
        }

        .theme-selector {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .theme-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 3px solid white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: scale(1.15);
        }

        .theme-btn.active {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(255,255,255,0.8);
        }

        .theme-btn.spring { 
            background: linear-gradient(45deg, #7fc97f, #a8dadc, #d3e6d2, #f9c507);
        }
        .theme-btn.blossom { 
            background: linear-gradient(45deg, #f7cac9, #e8e0f0, #f0b5d5, #ea84a3);
        }
        .theme-btn.lavender { 
            background: linear-gradient(45deg, #9f75ce, #d8b3e0, #af8fd0, #f7df87);
        }
        .theme-btn.sunset { 
            background: linear-gradient(45deg, #fca37c, #ffd275, #f9d580, #7ac7e2);
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
        }
        
        .nav-tabs {
            display: flex;
            background: var(--accent-color);
            transition: all 0.3s ease;
        }
        
        .nav-tab {
            flex: 1;
            padding: 18px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            color: var(--text-color);
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-tab.active {
            background: rgba(255, 255, 255, 0.95);
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .nav-tab:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 35px;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section {
            margin-bottom: 35px;
            padding: 30px;
            border-radius: 15px;
            border-left: 5px solid var(--primary-color);
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .section h2 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 25px;
        }

        .section h3 {
            color: var(--primary-color);
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: var(--text-color);
            font-size: 1.1em;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .task-config-item {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 15px;
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.95);
            transition: all 0.3s ease;
        }

        .task-config-item:hover {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }
        
        .task-config-item input {
            flex: 1;
            border: none;
            padding: 8px;
            background: transparent;
            font-size: 1.1em;
        }
        
        .task-config-item input[type="number"] {
            width: 70px;
        }
        
        .task-config-item button {
            background: var(--warning-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .task-config-item button:hover {
            background: #ff5252;
            transform: scale(1.05);
        }

        .reward-config-item {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 15px;
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.95);
            transition: all 0.3s ease;
        }

        .reward-config-item:hover {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }
        
        .reward-config-item input {
            flex: 1;
            border: none;
            padding: 8px;
            background: transparent;
            font-size: 1.1em;
        }
        
        .reward-config-item input[type="number"] {
            width: 90px;
        }

        .reward-config-item select {
            border: none;
            background: transparent;
            font-size: 1.1em;
        }

        .checkin-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }
        
        .checkin-panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .checkin-panel:hover {
            transform: translateY(-3px);
        }

        .checkin-panel h3 {
            color: var(--text-color);
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 12px 0;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .task-item:hover {
            transform: translateX(5px);
            border-color: var(--primary-color);
        }
        
        .task-item.completed {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            transform: scale(1.02);
        }
        
        .task-checkbox {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .task-name {
            flex: 1;
            font-weight: 500;
            font-size: 1.1em;
        }
        
        .task-points {
            background: var(--highlight-color);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 1em;
            font-weight: bold;
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        .completed .task-points {
            background: white;
            color: var(--primary-color);
        }
        
        .score-display {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-top: 25px;
            transition: all 0.3s ease;
        }

        .score-display:hover {
            transform: translateY(-3px);
        }
        
        .daily-score {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .total-score {
            font-size: 1.8em;
            color: var(--text-light);
            margin-bottom: 25px;
        }

        .progress-ring {
            width: 130px;
            height: 130px;
            margin: 20px auto;
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            fill: none;
            stroke: var(--accent-color);
            stroke-width: 10;
        }
        
        .progress-ring-progress {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 10;
            stroke-linecap: round;
            transition: all 0.8s ease;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--highlight-color), var(--accent-color));
            color: var(--text-color);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--warning-color), #ff5252);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #40c057);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: var(--text-light);
            font-weight: 500;
            font-size: 1.1em;
        }

        .daily-records {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .daily-records:hover {
            transform: translateY(-3px);
        }
        
        .records-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .records-body {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            border-bottom: 1px solid var(--accent-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }
        
        .record-item:hover {
            background: var(--accent-color);
            transform: translateX(5px);
        }
        
        .record-date {
            font-weight: bold;
            color: var(--text-color);
        }
        
        .record-score {
            font-weight: bold;
            color: var(--primary-color);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .chart-container:hover {
            transform: translateY(-3px);
        }

        .chart-title {
            text-align: center;
            color: var(--text-color);
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 1.4em;
        }

        .reward-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
        }
        
        .reward-table th,
        .reward-table td {
            padding: 18px;
            text-align: left;
            border-bottom: 1px solid var(--accent-color);
            color: var(--text-color);
            font-size: 1.1em;
        }
        
        .reward-table th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-weight: bold;
        }
        
        .reward-table tr {
            transition: all 0.3s ease;
        }
        
        .reward-table tr:hover {
            background: var(--accent-color);
            transform: scale(1.01);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            padding: 18px 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateX(100%);
            transition: all 0.4s ease;
            max-width: 350px;
            font-size: 1.1em;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.warning {
            background: var(--warning-color);
        }

        .reward-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--highlight-color), var(--primary-color));
            color: var(--text-color);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            transform: translateX(100%);
            transition: all 0.5s ease;
            max-width: 380px;
            border: 3px solid white;
        }
        
        .reward-alert.show {
            transform: translateX(0);
        }
        
        .reward-alert h3 {
            margin-bottom: 12px;
            color: var(--text-color);
            font-size: 1.3em;
        }

        .reward-alert p {
            color: var(--text-light);
            font-size: 1.1em;
        }
        
        .reward-alert .close-btn {
            position: absolute;
            top: 8px;
            right: 12px;
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--text-color);
        }

        .highlight {
            background: rgba(255, 255, 255, 0.9);
            padding: 22px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid var(--primary-color);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            color: var(--text-color);
            backdrop-filter: blur(10px);
            font-size: 1.1em;
        }

        .highlight:hover {
            transform: translateY(-2px);
        }

        .highlight strong {
            color: var(--primary-color);
        }

        .setup-complete {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid #4caf50;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            color: #2e7d32;
            font-size: 1.2em;
            margin-bottom: 25px;
        }

        .eva-message {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 248, 240, 0.95));
            border: 2px solid var(--highlight-color);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .eva-message::before {
            content: 'ğŸ‘©â€ğŸ«';
            position: absolute;
            top: -15px;
            left: 20px;
            background: var(--highlight-color);
            padding: 10px 15px;
            border-radius: 50%;
            font-size: 1.4em;
        }

        .eva-message:hover {
            transform: translateY(-3px);
        }

        .eva-title {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 15px;
            margin-top: 8px;
        }

        .eva-content {
            color: var(--text-color);
            line-height: 1.7;
            font-size: 1.15em;
        }

        .verification-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .verification-modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            margin: 20px;
        }

        .verification-code {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
            background: var(--accent-color);
            padding: 15px 30px;
            border-radius: 10px;
            margin: 20px 0;
            letter-spacing: 3px;
            font-family: monospace;
        }

        .guide-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid var(--primary-color);
            box-shadow: var(--shadow);
        }

        .guide-section h4 {
            color: var(--primary-color);
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .guide-list {
            list-style: none;
            padding-left: 0;
        }

        .guide-list li {
            padding: 8px 0;
            border-bottom: 1px dashed var(--accent-color);
            font-size: 1.1em;
        }

        .guide-list li:before {
            content: "âœ“ ";
            color: var(--primary-color);
            font-weight: bold;
            margin-right: 8px;
        }

        .intro-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 255, 254, 0.95));
            border: 2px solid var(--primary-color);
            border-radius: 20px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: var(--shadow);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .intro-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--highlight-color));
        }

        .intro-card h3 {
            color: var(--primary-color);
            font-size: 1.6em;
            margin-bottom: 20px;
        }

        .intro-card p {
            font-size: 1.15em;
            line-height: 1.7;
            color: var(--text-color);
        }

        .save-notice {
            background: linear-gradient(135deg, rgba(249, 197, 7, 0.1), rgba(255, 255, 255, 0.9));
            border: 2px solid var(--highlight-color);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .save-notice h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .checkin-container {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .tab-content {
                padding: 25px;
            }

            .theme-selector {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .signature {
                position: static;
                text-align: center;
                margin: 20px 0;
            }

            .save-buttons {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
            }

            body {
                font-size: 15px;
            }

            .verification-modal-content {
                padding: 30px 20px;
            }

            .verification-code {
                font-size: 1.5em;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body data-theme="spring">
    <!-- ä¸€é”®ä¿å­˜/åŠ è½½æŒ‰é’® -->
    <div class="save-buttons">
        <button class="save-btn" onclick="saveAllDataToFile()" title="ä¸€é”®ä¿å­˜æ‰€æœ‰æ•°æ®åˆ°æ–‡ä»¶">ğŸ’¾ ä¸€é”®ä¿å­˜</button>
        <button class="load-btn" onclick="loadDataFromFile()" title="ä»æ–‡ä»¶åŠ è½½æ•°æ®">ğŸ“‚ åŠ è½½æ•°æ®</button>
        <input type="file" id="load-file-input" accept=".json" style="display: none;" onchange="handleFileLoad(this)">
    </div>

    <!-- ç½²å -->
    <div class="signature">
        Evaè€å¸ˆğŸ‘©â€ğŸ«ä¼´æ­¥è‹±è¯­
    </div>

    <!-- è‡ªåŠ¨ä¿å­˜æŒ‡ç¤ºå™¨ -->
    <div class="auto-save-indicator" id="auto-save-indicator">
        ğŸ’¾ æ•°æ®å·²ä¿å­˜åˆ°æ–‡ä»¶
    </div>

    <!-- éªŒè¯ç å¼¹çª— -->
    <div class="verification-modal" id="verification-modal">
        <div class="verification-modal-content">
            <h3>ğŸ” å®‰å…¨éªŒè¯</h3>
            <p style="margin: 15px 0; font-size: 1.1em;">ä¸ºäº†é˜²æ­¢è¯¯æ“ä½œï¼Œè¯·è¾“å…¥ä¸‹æ–¹æ˜¾ç¤ºçš„éªŒè¯ç ï¼š</p>
            <div class="verification-code" id="verification-code">ABCD12</div>
            <input type="text" id="verification-input" placeholder="è¯·è¾“å…¥éªŒè¯ç " style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1em; margin: 15px 0; text-align: center; letter-spacing: 2px;">
            <div style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="confirmReset()">ç¡®è®¤é‡ç½®</button>
                <button class="btn btn-secondary" onclick="closeVerificationModal()">å–æ¶ˆ</button>
            </div>
            <p style="margin-top: 15px; color: #666; font-size: 0.9em;">âš ï¸ é‡ç½®åæ‰€æœ‰æ•°æ®å°†è¢«æ¸…ç©ºä¸”æ— æ³•æ¢å¤</p>
        </div>
    </div>

    <!-- å¥–åŠ±æé†’å¼¹çª— -->
    <div class="reward-alert" id="reward-alert">
        <button class="close-btn" onclick="closeRewardAlert()">&times;</button>
        <h3 id="reward-title">ğŸ‰ æ­å–œè·å¾—å¥–åŠ±ï¼</h3>
        <p id="reward-message">ä½ å¤ªæ£’äº†ï¼</p>
    </div>

    <div class="container">
        <div class="header">
            <div class="theme-selector">
                <div class="theme-btn spring active" onclick="setTheme('spring')" title="æ˜¥æ„ç›ç„¶"></div>
                <div class="theme-btn blossom" onclick="setTheme('blossom')" title="æ¨±èŠ±ç²‰å«©"></div>
                <div class="theme-btn lavender" onclick="setTheme('lavender')" title="è–°è¡£è‰ç´«"></div>
                <div class="theme-btn sunset" onclick="setTheme('sunset')" title="å¤•é˜³æ©™é»„"></div>
            </div>
            <h1 id="plan-title">ğŸŒŸ å­¦ä¹ æˆé•¿è®¡åˆ’ ğŸŒŸ</h1>
            <p id="plan-subtitle">æœ‰ç›®æ ‡ æœ‰è®¡åˆ’ æœ‰è¡ŒåŠ¨ æœ‰æˆé•¿</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab" onclick="showTab(event, 'guide')" id="guide-tab">ğŸ“– ä½¿ç”¨æŒ‡å—</button>
            <button class="nav-tab" onclick="showTab(event, 'setup')" id="setup-tab">âš™ï¸ ä¸ªäººè®¾ç½®</button>
            <button class="nav-tab" onclick="showTab(event, 'checkin')" id="checkin-tab" style="display: none;">ğŸ“ æ¯æ—¥æ‰“å¡</button>
            <button class="nav-tab" onclick="showTab(event, 'records')" id="records-tab" style="display: none;">ğŸ“Š è¿›åº¦è®°å½•</button>
            <button class="nav-tab" onclick="showTab(event, 'analysis')" id="analysis-tab" style="display: none;">ğŸ“ˆ æ•°æ®åˆ†æ</button>
            <button class="nav-tab" onclick="showTab(event, 'rewards')" id="rewards-tab" style="display: none;">ğŸ† å¥–åŠ±ç³»ç»Ÿ</button>
            <button class="nav-tab" onclick="showTab(event, 'backup')" id="backup-tab" style="display: none;">ğŸ’¾ æ•°æ®ç®¡ç†</button>
        </div>
        
        <!-- ä½¿ç”¨æŒ‡å—é¡µé¢ -->
        <div class="tab-content" id="guide">
            <div class="save-notice">
                <h3>ğŸ“Œ é‡è¦æç¤º ğŸ“Œ</h3>
                <p>ä¸ºäº†ç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ï¼Œè¯·ç»å¸¸ç‚¹å‡»å·¦ä¸Šè§’çš„"ğŸ’¾ ä¸€é”®ä¿å­˜"æŒ‰é’®ï¼ä¸‹æ¬¡æ‰“å¼€ç½‘é¡µæ—¶ï¼Œç‚¹å‡»"ğŸ“‚ åŠ è½½æ•°æ®"å³å¯æ¢å¤æ‰€æœ‰æ•°æ®ã€‚ğŸ˜Š</p>
            </div>

            <div class="intro-card">
                <h3>ğŸŒˆ Evaè€å¸ˆçš„è®¾è®¡åˆè¡·</h3>
                <p>äº²çˆ±çš„å®¶é•¿å’Œå­©å­ä»¬ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ï¼Œæˆ‘è®¾è®¡è¿™ä¸ªå­¦ä¹ æˆé•¿è®¡åˆ’çš„åˆè¡·ï¼Œæ˜¯å¸Œæœ›æ¯ä¸ªå­©å­éƒ½èƒ½åœ¨å­¦ä¹ ä¸­æ‰¾åˆ°ä¹è¶£ï¼Œåœ¨æˆé•¿ä¸­æ”¶è·å¿«ä¹ã€‚æˆ‘ç›¸ä¿¡<strong>æœ‰ç›®æ ‡ã€æœ‰è®¡åˆ’ã€æœ‰è¡ŒåŠ¨ã€æœ‰æˆé•¿</strong>çš„å­¦ä¹ æ–¹å¼ï¼Œèƒ½è®©å­©å­ä»¬ä¸ä»…æå‡å­¦ä¹ æˆç»©ï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹å…»è‰¯å¥½çš„å­¦ä¹ ä¹ æƒ¯å’Œè‡ªæˆ‘ç®¡ç†èƒ½åŠ›ã€‚ğŸŒ±âœ¨</p>
            </div>

            <div class="intro-card">
                <h3>ğŸ¯ æˆé•¿è”ç›Ÿçš„åŠ›é‡</h3>
                <p>äº²çˆ±çš„å­©å­ ğŸ§’ï¼Œè¦çŸ¥é“åœ¨ä½ æˆé•¿çš„è·¯ä¸Šï¼Œçˆ¸çˆ¸å¦ˆå¦ˆ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ã€è€å¸ˆ ğŸ‘©â€ğŸ« å’Œä½ è‡ªå·±æ˜¯ä¸€ä¸ªå¼ºå¤§çš„"æˆé•¿è”ç›Ÿ"ï¼æˆ‘ä»¬éƒ½åœ¨ç”¨ä¸åŒçš„æ–¹å¼æ”¯æŒä½ ã€é¼“åŠ±ä½ ã€‚ä½†æ˜¯ï¼Œæœ€é‡è¦çš„æ˜¯<strong>ä½ è‡ªå·±è¦ç‡ƒèµ·é‚£é¢—æœç€ç›®æ ‡ä¸æ–­å‰è¿›çš„å¿ƒ â¤ï¸â€ğŸ”¥</strong>ï¼å¤–åœ¨çš„å¥–åŠ±åªæ˜¯å¸®åŠ©ä½ çœ‹åˆ°è‡ªå·±çš„è¿›æ­¥ï¼ŒçœŸæ­£çš„åŠ¨åŠ›æ¥è‡ªäºä½ å†…å¿ƒå¯¹æˆé•¿çš„æ¸´æœ›å’Œå¯¹ç¾å¥½æœªæ¥çš„æ†§æ†¬ã€‚ğŸš€ğŸŒŸ</p>
            </div>

            <div class="intro-card">
                <h3>ğŸ® è®©æˆé•¿çœ‹å¾—è§</h3>
                <p>è¿™ä¸ªç³»ç»Ÿé‡‡ç”¨ç§¯åˆ†åˆ¶å’Œé˜¶æ®µæ€§æ¿€åŠ±ï¼Œè®©å­¦ä¹ å˜å¾—å¯è§†åŒ–ã€æ¸¸æˆåŒ– ğŸ²ã€‚é€šè¿‡æ¯æ—¥æ‰“å¡ã€è¿›åº¦è¿½è¸ªå’Œæ•°æ®åˆ†æï¼Œå¸®åŠ©å­©å­ä»¬çœ‹åˆ°è‡ªå·±æ¯ä¸€å¤©çš„æˆé•¿è¶³è¿¹ ğŸ‘£ã€‚åœ¨çœŸæ­£å…»æˆå¥½ä¹ æƒ¯ä¹‹å‰ï¼Œè¿™äº›å¯è§†åŒ–çš„æˆæœå’Œé˜¶æ®µæ€§çš„æ­£å‘æ¿€åŠ±ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå¸®åŠ©å­©å­åŸ¹å…»æŒç»­çš„å­¦ä¹ ä¹ æƒ¯ï¼Œå°±åƒæ¸¸æˆä¸­çš„å‡çº§ç³»ç»Ÿä¸€æ ·æœ‰è¶£ï¼ğŸŠ</p>
            </div>

            <div class="section">
                <h2>ğŸ“š è¯¦ç»†ä½¿ç”¨è¯´æ˜</h2>
                
                <div class="guide-section">
                    <h4>ğŸ’¾ è¶…é‡è¦ï¼šæ•°æ®ä¿å­˜ç§˜ç± ğŸ”</h4>
                    <ul class="guide-list">
                        <li>ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè®°å¾—ç»å¸¸ç‚¹å‡»å·¦ä¸Šè§’"ğŸ’¾ ä¸€é”®ä¿å­˜"æŒ‰é’® ğŸ‘†</li>
                        <li>ä¿å­˜åä¼šä¸‹è½½ä¸€ä¸ªæ•°æ®æ–‡ä»¶åˆ°ç”µè„‘ï¼Œè¿™æ˜¯ä½ çš„å­¦ä¹ å®è— ğŸ’</li>
                        <li>ä¸‹æ¬¡æ‰“å¼€ç½‘é¡µæ—¶ï¼Œç‚¹å‡»"ğŸ“‚ åŠ è½½æ•°æ®"é€‰æ‹©ä¹‹å‰ä¿å­˜çš„æ–‡ä»¶ ğŸ“</li>
                        <li>è¿™æ ·å°±èƒ½å®Œç¾æ¢å¤æ‰€æœ‰å­¦ä¹ è®°å½•å’Œè®¾ç½® âœ¨</li>
                        <li>å»ºè®®æ¯æ¬¡ä½¿ç”¨ç»“æŸéƒ½ä¿å­˜ä¸€æ¬¡ï¼Œæ•°æ®å®‰å…¨æœ€é‡è¦ ğŸ›¡ï¸</li>
                    </ul>
                </div>
                
                <div class="guide-section">
                    <h4>ğŸ› ï¸ ç¬¬ä¸€æ­¥ï¼šä¸ªäººä¸“å±è®¾ç½®</h4>
                    <ul class="guide-list">
                        <li>è¾“å…¥ä½ çš„ä¸“å±å§“åå’Œå¹´çº§ä¿¡æ¯ ğŸ“</li>
                        <li>è®¾ç½®å­¦ä¹ è®¡åˆ’çš„æ—¶é—´æ®µï¼ˆæš‘å‡ã€å¯’å‡éƒ½å¯ä»¥å“¦ï¼‰ğŸ“…</li>
                        <li>ç»™è®¡åˆ’èµ·ä¸ªé…·ç‚«çš„åå­—ï¼Œæ¯”å¦‚"è¶…çº§å­¦éœ¸å…»æˆè®¡åˆ’" ğŸ¦¸â€â™‚ï¸</li>
                        <li>è®¾ç½®æ¯æ—¥ç›®æ ‡åˆ†æ•°å’Œç»ˆæå¤§ç›®æ ‡ ğŸ¯</li>
                        <li>è‡ªå®šä¹‰å­¦ä¹ ä»»åŠ¡æ¸…å•ï¼ˆæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ç§¯åˆ†å¥–åŠ±ï¼‰ğŸ“‹</li>
                        <li>æ·»åŠ ç”Ÿæ´»å¥½ä¹ æƒ¯åŸ¹å…»é¡¹ç›® ğŸŒ±</li>
                        <li>è®¾è®¡ä¸“å±å¥–åŠ±æœºåˆ¶ï¼Œè®©åŠªåŠ›å˜å¾—æ›´æœ‰ç›¼å¤´ ğŸ</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h4>ğŸ“ ç¬¬äºŒæ­¥ï¼šæ¯æ—¥æˆé•¿æ‰“å¡</h4>
                    <ul class="guide-list">
                        <li>æ¯å¤©é€‰æ‹©å½“å‰æ—¥æœŸå¼€å§‹ä½ çš„æˆé•¿ä¹‹æ—… ğŸ“†</li>
                        <li>é€ä¸€å‹¾é€‰å®Œæˆçš„ä»»åŠ¡ï¼Œæ¯ä¸€ä¸ªâœ“éƒ½æ˜¯æˆé•¿çš„è¯æ˜ âœ…</li>
                        <li>ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—ä»Šæ—¥å¾—åˆ†å’Œæ€»æˆ˜æ–—åŠ› ğŸ’ª</li>
                        <li>è¾¾åˆ°ç›®æ ‡åˆ†æ•°åç‚¹å‡»"ä¿å­˜å½“æ—¥è¿›åº¦"è®°å½•æˆæœ ğŸ’¾</li>
                        <li>è§‚å¯Ÿè¿›åº¦ç¯çš„ç¥å¥‡å˜åŒ–ï¼Œæ„Ÿå—æ¯æ—¥çš„èœ•å˜ ğŸ”„</li>
                        <li>å¯ä»¥è¡¥ç­¾ä¹‹å‰çš„æ—¥æœŸï¼Œä½†ä¸èƒ½ç©¿è¶Šåˆ°æœªæ¥å“¦ â°</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h4>ğŸ“Š ç¬¬ä¸‰æ­¥ï¼šæˆé•¿è½¨è¿¹è¿½è¸ª</h4>
                    <ul class="guide-list">
                        <li>åœ¨"è¿›åº¦è®°å½•"çœ‹åˆ°ä½ æ‰€æœ‰çš„åŠªåŠ›è¶³è¿¹ ğŸ‘£</li>
                        <li>ç‚¹å‡»ä»»æ„è®°å½•å¯ä»¥æ—¶å…‰å›æº¯åˆ°é‚£ä¸€å¤© â³</li>
                        <li>æŸ¥çœ‹å®Œæˆå¤©æ•°ã€å¹³å‡å¾—åˆ†ç­‰ç‚«é…·æ•°æ® ğŸ“ˆ</li>
                        <li>äº†è§£è‡ªå·±çš„å­¦ä¹ å®Œæˆç‡å’Œæœªæ¥é¢„æµ‹ ğŸ”®</li>
                        <li>é€šè¿‡æ•°æ®å‘ç°è‡ªå·±çš„å­¦ä¹ è¶…èƒ½åŠ› ğŸ¦¸â€â™€ï¸</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h4>ğŸ¤– ç¬¬å››æ­¥ï¼šæ™ºèƒ½åˆ†æä¸å»ºè®®</h4>
                    <ul class="guide-list">
                        <li>æŸ¥çœ‹å­¦ä¹ ä»»åŠ¡å’Œç”Ÿæ´»ä¹ æƒ¯çš„å®Œæˆç‡åˆ†æ ğŸ“Š</li>
                        <li>å‘ç°è‡ªå·±çš„"æœ€é•¿è¿å‡»è®°å½•"å’Œå‘¨å¹³å‡æˆ˜æ–—åŠ› ğŸ”¥</li>
                        <li>é˜…è¯»Evaè€å¸ˆçš„ä¸ªæ€§åŒ–å»ºè®®å’Œæš–å¿ƒé¼“åŠ± ğŸ’•</li>
                        <li>æ ¹æ®ä¸“ä¸šå»ºè®®ä¼˜åŒ–å­¦ä¹ ç­–ç•¥å’Œç›®æ ‡è®¾å®š ğŸ¯</li>
                        <li>æŒç»­è¿›åŒ–ï¼Œæˆä¸ºæ›´å¥½çš„è‡ªå·± ğŸŒŸ</li>
                    </ul>
                </div>

                <div class="guide-section">
                    <h4>ğŸ† ç¬¬äº”æ­¥ï¼šæˆå°±è§£é”ä¸åº†ç¥</h4>
                    <ul class="guide-list">
                        <li>åœ¨"å¥–åŠ±ç³»ç»Ÿ"æŸ¥çœ‹ä½ çš„æˆå°±æ”¶é›†è¿›åº¦ ğŸ…</li>
                        <li>è¾¾æˆæ¡ä»¶æ—¶ä¼šæœ‰æƒŠå–œå¼¹çª—åº†ç¥ä½ çš„åŠªåŠ› ğŸ‰</li>
                        <li>å®¶é•¿è¦åŠæ—¶å…‘ç°æ‰¿è¯ºï¼Œè®©æˆå°±æ„Ÿçˆ†æ£š ğŸ’</li>
                        <li>å¯ä»¥éšæ—¶è°ƒæ•´å¥–åŠ±å†…å®¹ï¼Œä¿æŒæ–°é²œæ„Ÿ ğŸ†•</li>
                        <li>è®°ä½ï¼šå¥–åŠ±æ˜¯æˆé•¿è·¯ä¸Šçš„åŠ æ²¹ç«™ï¼Œä¸æ˜¯ç»ˆç‚¹ â›½</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ’¡ æˆé•¿æ™ºæ…§åˆ†äº«</h2>
                
                <div class="highlight">
                    <strong>ğŸ’Œ ç»™å®¶é•¿çš„è´´å¿ƒè¯ï¼š</strong>è¿™ä¸ªå·¥å…·æ˜¯å­©å­å…»æˆå¥½ä¹ æƒ¯çš„å¾—åŠ›åŠ©æ‰‹ï¼Œä½†æœ€å…³é”®çš„æ˜¯æ‚¨çš„é™ªä¼´å’Œé¼“åŠ± ğŸ¤—ã€‚å»ºè®®æ¯å¤©èŠ±å‡ åˆ†é’Ÿå’Œå­©å­ä¸€èµ·å›é¡¾å­¦ä¹ æƒ…å†µï¼Œç»™äºˆæ¸©æš–çš„åé¦ˆã€‚åœ¨å­©å­çœŸæ­£å…»æˆå¥½ä¹ æƒ¯ä¹‹å‰ï¼Œè¿™äº›å¯è§†åŒ–çš„è¿›æ­¥å’Œé˜¶æ®µæ€§çš„æ­£å‘æ¿€åŠ±èƒ½å¤Ÿæœ‰æ•ˆæ”¯æŒä»–ä»¬å»ºç«‹æŒç»­å­¦ä¹ çš„ä¿¡å¿ƒã€‚è®°ä½è¦åŠæ—¶å…‘ç°å¥–åŠ±æ‰¿è¯ºï¼Œä¹Ÿåˆ«å¿˜äº†ç»å¸¸ä¿å­˜æ•°æ®å“¦ï¼ğŸ’¾
                </div>

                <div class="highlight">
                    <strong>ğŸŒŸ ç»™å­©å­çš„é¼“åŠ±è¯ï¼š</strong>å­¦ä¹ å°±åƒç©RPGæ¸¸æˆä¸€æ ·ï¼Œæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡å°±èƒ½è·å¾—ç»éªŒå€¼ï¼Œç§¯åˆ†è¶Šå¤šç­‰çº§è¶Šé«˜ï¼ğŸ® ä¸è¦å› ä¸ºæŸä¸€å¤©çš„å¾—åˆ†ä½è€Œæ°”é¦ï¼ŒçœŸæ­£çš„å‹‡è€…çŸ¥é“ï¼Œä¸æ€•æ…¢ï¼Œå°±æ€•åœï¼è®°ä½ï¼Œå¤–åœ¨çš„å¥–åŠ±å¾ˆæ£’ï¼Œä½†æœ€é‡è¦çš„æ˜¯ä½ å†…å¿ƒé‚£è‚¡"æˆ‘è¦å˜å¾—æ›´æ£’"çš„ç«ç„° ğŸ”¥ã€‚æ¯ä¸€å¤©çš„åŠªåŠ›éƒ½æ˜¯åœ¨ä¸ºæœªæ¥çš„è‡ªå·±ç§¯æ”’è¶…èƒ½åŠ›ï¼ğŸ’ªâœ¨
                </div>

                <div class="highlight">
                    <strong>ğŸ”„ æˆé•¿è”ç›Ÿå®£è¨€ï¼š</strong>æˆ‘ä»¬æ˜¯å­©å­æˆé•¿è·¯ä¸Šçš„åŒç›Ÿå†› ğŸ‘¥ï¼çˆ¸çˆ¸å¦ˆå¦ˆæä¾›çˆ±ä¸æ”¯æŒï¼Œè€å¸ˆæä¾›æ–¹æ³•ä¸æŒ‡å¯¼ï¼Œè€Œå­©å­è‡ªå·±æ˜¯è¿™åœºæˆé•¿å†’é™©çš„ä¸»è§’ ğŸŒŸã€‚è¿™ä¸ªç³»ç»Ÿä¸ä»…é€‚ç”¨äºå‡æœŸï¼Œä¹Ÿèƒ½ç”¨äºæ—¥å¸¸å­¦ä¹ ã€æœŸæœ«å†²åˆºã€å…´è¶£åŸ¹å…»ç­‰å„ç§åœºæ™¯ã€‚è®©æˆ‘ä»¬é½å¿ƒååŠ›ï¼Œç‚¹ç‡ƒå­©å­å†…å¿ƒçš„æˆé•¿ç«ç„°ï¼ğŸ”¥ğŸš€
                </div>
            </div>

            <div class="intro-card">
                <h3>ğŸŒˆ Evaè€å¸ˆçš„æˆé•¿ç¥ç¦</h3>
                <p>å¸Œæœ›é€šè¿‡è¿™ä¸ªæ¸©æš–çš„å°å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©æ¯ä¸ªå­©å­å»ºç«‹èµ·è‡ªä¸»å­¦ä¹ çš„è¶…èƒ½åŠ›å’Œå—ç›Šç»ˆç”Ÿçš„å¥½ä¹ æƒ¯ ğŸ¦¸â€â™‚ï¸ã€‚å­¦ä¹ ä¸åº”è¯¥æ˜¯ç—›è‹¦çš„è´Ÿæ‹…ï¼Œè€Œåº”è¯¥æ˜¯å……æ»¡æˆå°±æ„Ÿå’Œå¿«ä¹çš„æˆé•¿å†’é™© ğŸ¯ï¼åœ¨çˆ¸çˆ¸å¦ˆå¦ˆã€è€å¸ˆå’Œä½ è‡ªå·±ç»„æˆçš„"æˆé•¿è”ç›Ÿ"æ”¯æŒä¸‹ï¼Œç›¸ä¿¡æ¯ä¸ªå­©å­éƒ½èƒ½ç‡ƒèµ·å†…å¿ƒçš„æˆé•¿ç«ç„°ï¼Œä¸ä»…åœ¨å­¦ä¹ ä¸Šè¿›æ­¥ï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹å…»å‡ºåšéŸ§ä¸æ‹”ã€ç§¯æå‘ä¸Šçš„ç¾å¥½å“æ ¼ï¼åŠ æ²¹ï¼Œæœªæ¥çš„ä½ ä¸€å®šä¼šæ„Ÿè°¢ç°åœ¨åŠªåŠ›çš„è‡ªå·±ï¼ğŸŒŸğŸ’–</p>
            </div>
        </div>
        
        <!-- ä¸ªäººè®¾ç½®é¡µé¢ -->
        <div class="tab-content" id="setup">
            <div class="section">
                <h2>âš™ï¸ ä¸ªäººä¿¡æ¯è®¾ç½®</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="student-name">å­©å­å§“åï¼š</label>
                        <input type="text" id="student-name" placeholder="è¯·è¾“å…¥å§“å">
                    </div>
                    <div class="form-group">
                        <label for="student-grade">å¹´çº§ï¼š</label>
                        <select id="student-grade">
                            <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                            <option value="ä¸€å¹´çº§">ä¸€å¹´çº§</option>
                            <option value="äºŒå¹´çº§">äºŒå¹´çº§</option>
                            <option value="ä¸‰å¹´çº§">ä¸‰å¹´çº§</option>
                            <option value="å››å¹´çº§">å››å¹´çº§</option>
                            <option value="äº”å¹´çº§">äº”å¹´çº§</option>
                            <option value="å…­å¹´çº§">å…­å¹´çº§</option>
                            <option value="åˆä¸€">åˆä¸€</option>
                            <option value="åˆäºŒ">åˆäºŒ</option>
                            <option value="åˆä¸‰">åˆä¸‰</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="plan-name">è®¡åˆ’åç§°ï¼š</label>
                    <input type="text" id="plan-name" placeholder="å¦‚ï¼šæš‘å‡å­¦ä¹ è®¡åˆ’ã€æœŸæœ«å†²åˆºè®¡åˆ’ç­‰" value="æš‘å‡å­¦ä¹ æˆé•¿è®¡åˆ’">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="vacation-start">è®¡åˆ’å¼€å§‹æ—¥æœŸï¼š</label>
                        <input type="date" id="vacation-start">
                    </div>
                    <div class="form-group">
                        <label for="vacation-end">è®¡åˆ’ç»“æŸæ—¥æœŸï¼š</label>
                        <input type="date" id="vacation-end">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="daily-target">æ¯æ—¥ä¼˜ç§€æ ‡å‡†åˆ†æ•°ï¼š</label>
                        <input type="number" id="daily-target" min="20" max="100" value="35" placeholder="35">
                    </div>
                    <div class="form-group">
                        <label for="final-target">æœ€ç»ˆç›®æ ‡æ€»åˆ†ï¼š</label>
                        <input type="number" id="final-target" min="500" max="5000" value="1200" placeholder="1200">
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>ğŸ“š å­¦ä¹ ä»»åŠ¡è®¾ç½®</h2>
                <div id="study-tasks"></div>
                <button class="btn btn-secondary" onclick="addStudyTask()">+ æ·»åŠ å­¦ä¹ ä»»åŠ¡</button>
            </div>
            
            <div class="section">
                <h2>ğŸ’ª ç”Ÿæ´»ä¹ æƒ¯è®¾ç½®</h2>
                <div id="life-habits"></div>
                <button class="btn btn-secondary" onclick="addLifeHabit()">+ æ·»åŠ ç”Ÿæ´»ä¹ æƒ¯</button>
            </div>

            <div class="section">
                <h2>ğŸ† æˆé•¿æ¿€åŠ±è®¾ç½®</h2>
                <div id="reward-items"></div>
                <button class="btn btn-secondary" onclick="addRewardItem()">+ æ·»åŠ æ¿€åŠ±é¡¹ç›®</button>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-success" onclick="saveSetup()" style="font-size: 1.3em; padding: 18px 35px;">
                    âœ… ä¿å­˜è®¾ç½®å¹¶å¼€å§‹ä½¿ç”¨
                </button>
            </div>
        </div>
        
        <!-- æ¯æ—¥æ‰“å¡é¡µé¢ -->
        <div class="tab-content" id="checkin">
            <div class="section">
                <h2>ğŸ“ æ¯æ—¥ä»»åŠ¡æ‰“å¡</h2>
                
                <div style="text-align: center; margin: 20px 0; padding: 20px; background: rgba(255,255,255,0.9); border-radius: 12px;">
                    <label for="check-date" style="font-size: 1.2em;">é€‰æ‹©æ—¥æœŸ: </label>
                    <input type="date" id="check-date" style="padding: 12px; border: 2px solid var(--primary-color); border-radius: 8px; margin: 0 15px; font-size: 1.1em;">
                    <button class="btn btn-secondary" onclick="setToday()">ä»Šå¤©</button>
                    <span style="margin-left: 20px; font-weight: bold; color: var(--primary-color); font-size: 1.2em;" id="current-date-display">ä»Šå¤©</span>
                </div>

                <div class="highlight">
                    <strong id="date-goal">ä»Šæ—¥ç›®æ ‡ï¼š</strong>å®Œæˆä»»åŠ¡ï¼Œè®°å½•æˆé•¿è¶³è¿¹ï¼æ¯ä¸€ä¸ªå‹¾é€‰éƒ½æ˜¯å‘ç›®æ ‡è¿ˆè¿›çš„ä¸€æ­¥ï¼
                </div>
                
                <div class="checkin-container">
                    <div class="checkin-panel">
                        <h3>ğŸ“š å­¦ä¹ ä»»åŠ¡</h3>
                        <div id="study-checkin">
                            <!-- å­¦ä¹ ä»»åŠ¡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <div class="checkin-panel">
                        <h3>ğŸ’ª ç”Ÿæ´»ä¹ æƒ¯</h3>
                        <div id="life-checkin">
                            <!-- ç”Ÿæ´»ä¹ æƒ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <div class="score-display">
                    <div class="daily-score">å½“æ—¥å¾—åˆ†: <span id="daily-score">0</span>/<span id="max-score">0</span>åˆ†</div>
                    <div class="total-score">ç´¯è®¡æ€»åˆ†: <span id="total-score">0</span>åˆ†</div>
                    
                    <svg class="progress-ring">
                        <circle class="progress-ring-circle" cx="65" cy="65" r="55"></circle>
                        <circle class="progress-ring-progress" cx="65" cy="65" r="55" id="progress-circle"></circle>
                    </svg>
                    
                    <div style="margin-top: 25px;">
                        <button class="btn" onclick="saveProgress()">ğŸ’¾ ä¿å­˜å½“æ—¥è¿›åº¦</button>
                        <button class="btn btn-secondary" onclick="resetDaily()">ğŸ”„ é‡ç½®å½“æ—¥</button>
                        <button class="btn btn-danger" onclick="showVerificationModal()">ğŸ—‘ï¸ å…¨éƒ¨é‡ç½®</button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="completed-days">0</div>
                        <div class="stat-label">å®Œæˆå¤©æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="average-score">0</div>
                        <div class="stat-label">å¹³å‡å¾—åˆ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="streak-days">0</div>
                        <div class="stat-label">è¿ç»­å¤©æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="target-progress">0%</div>
                        <div class="stat-label">ç›®æ ‡è¿›åº¦</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¿›åº¦è®°å½•é¡µé¢ -->
        <div class="tab-content" id="records">
            <div class="section">
                <h2>ğŸ“Š è¯¦ç»†è¿›åº¦è®°å½•</h2>
                <div class="daily-records">
                    <div class="records-header">
                        æ¯æ—¥å­¦ä¹ è®°å½• (ä»å¼€å§‹åˆ°ç°åœ¨çš„æ‰€æœ‰è®°å½•)
                    </div>
                    <div class="records-body" id="records-list"></div>
                </div>
                
                <div class="stats-grid" style="margin-top: 25px;">
                    <div class="stat-card">
                        <div class="stat-number" id="total-days">0</div>
                        <div class="stat-label">è®¡åˆ’æ€»å¤©æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="remaining-days">0</div>
                        <div class="stat-label">å‰©ä½™å¤©æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completion-rate">0%</div>
                        <div class="stat-label">å®Œæˆç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="predicted-total">0</div>
                        <div class="stat-label">é¢„æµ‹æ€»åˆ†</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ•°æ®åˆ†æé¡µé¢ -->
        <div class="tab-content" id="analysis">
            <div class="section">
                <h2>ğŸ“ˆ å­¦ä¹ æ•°æ®åˆ†æ</h2>
                
                <div class="chart-container">
                    <div class="chart-title">å­¦ä¹ è¡¨ç°ç»Ÿè®¡</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="study-completion">0%</div>
                            <div class="stat-label">å­¦ä¹ ä»»åŠ¡å®Œæˆç‡</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="habit-completion">0%</div>
                            <div class="stat-label">ç”Ÿæ´»ä¹ æƒ¯å®Œæˆç‡</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="best-streak">0</div>
                            <div class="stat-label">æœ€é•¿è¿ç»­å¤©æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="avg-weekly">0</div>
                            <div class="stat-label">å‘¨å¹³å‡å¾—åˆ†</div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">ğŸ‘©â€ğŸ«Evaè€å¸ˆå¯¹ä½ è¯´ï¼š</div>
                    <div id="study-suggestions"></div>
                </div>
            </div>
        </div>

        <!-- å¥–åŠ±ç³»ç»Ÿé¡µé¢ -->
        <div class="tab-content" id="rewards">
            <div class="section">
                <h2>ğŸ† æˆé•¿æ¿€åŠ±ç³»ç»Ÿ</h2>
                <div class="highlight">
                    <strong>ğŸ’¡ è®¾è®¡ç†å¿µï¼š</strong>é€šè¿‡å¯è§†åŒ–çš„æˆæœå±•ç¤ºå’Œé˜¶æ®µæ€§çš„æ­£å‘æ¿€åŠ±ï¼Œå¸®åŠ©å­©å­åœ¨çœŸæ­£å…»æˆå¥½ä¹ æƒ¯ä¹‹å‰ä¿æŒå­¦ä¹ çš„åŠ¨åŠ›å’Œä¿¡å¿ƒã€‚æ¯ä¸€ä»½åŠªåŠ›éƒ½å€¼å¾—è¢«çœ‹è§å’Œåº†ç¥ï¼ğŸ‰âœ¨
                </div>
                
                <div id="reward-display"></div>
            </div>
        </div>

        <!-- æ•°æ®ç®¡ç†é¡µé¢ -->
        <div class="tab-content" id="backup">
            <div class="section">
                <h2>ğŸ’¾ æ•°æ®å¤‡ä»½ä¸æ¢å¤</h2>
                
                <div style="background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                    <h3 style="font-size: 1.3em;">ğŸ“¥ æ•°æ®å¯¼å‡º</h3>
                    <p style="margin: 15px 0; color: var(--text-color); font-size: 1.1em;">å°†ä½ çš„å­¦ä¹ æ•°æ®å¯¼å‡ºå¤‡ä»½ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±</p>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" onclick="exportData()">ğŸ’¾ å¯¼å‡ºå­¦ä¹ æ•°æ®</button>
                        <button class="btn btn-secondary" onclick="generateReport()">ğŸ“‹ ç”Ÿæˆå­¦ä¹ æŠ¥å‘Š</button>
                    </div>
                </div>
                
                <div style="background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 12px;">
                    <h3 style="font-size: 1.3em;">ğŸ“¤ æ•°æ®æ¢å¤</h3>
                    <p style="margin: 15px 0; color: var(--text-color); font-size: 1.1em;">ä»å¤‡ä»½æ–‡ä»¶æ¢å¤ä½ çš„å­¦ä¹ æ•°æ®</p>
                    <div class="form-group">
                        <label for="import-file">é€‰æ‹©å¤‡ä»½æ–‡ä»¶ï¼š</label>
                        <input type="file" id="import-file" accept=".json" onchange="importData(this)">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€é…ç½®å’Œæ•°æ®
        let config = {
            studentName: '',
            studentGrade: '',
            planName: 'æš‘å‡å­¦ä¹ æˆé•¿è®¡åˆ’',
            vacationStart: '',
            vacationEnd: '',
            dailyTarget: 35,
            finalTarget: 1200,
            studyTasks: [],
            lifeHabits: [],
            rewardItems: [],
            setupComplete: false,
            theme: 'spring'
        };
        
        let dailyScore = 0;
        let totalScore = 0;
        let completedDays = 0;
        let streakDays = 0;
        let dailyRecords = [];
        let currentDate = new Date().toISOString().split('T')[0];
        let achievements = {};
        let currentVerificationCode = '';

        // ä¸€é”®ä¿å­˜åŠŸèƒ½ - ä¿å­˜æ‰€æœ‰æ•°æ®åˆ°æ–‡ä»¶
        function saveAllDataToFile() {
            const allData = {
                config: config,
                dailyRecords: dailyRecords,
                totalScore: totalScore,
                completedDays: completedDays,
                streakDays: streakDays,
                achievements: achievements,
                currentDate: currentDate,
                dailyScore: dailyScore,
                saveDate: new Date().toISOString(),
                version: '2.0'
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å­¦ä¹ è®¡åˆ’æ•°æ®_${config.studentName || 'æœªå‘½å'}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showSaveIndicator();
            showNotification('æ•°æ®å·²ä¿å­˜åˆ°æ–‡ä»¶ï¼ä¸‹æ¬¡æ‰“å¼€æ—¶è¯·åŠ è½½æ­¤æ–‡ä»¶ã€‚', 'success');
        }

        // åŠ è½½æ•°æ®æ–‡ä»¶
        function loadDataFromFile() {
            document.getElementById('load-file-input').click();
        }

        // å¤„ç†æ–‡ä»¶åŠ è½½
        function handleFileLoad(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const loadedData = JSON.parse(e.target.result);
                    
                    if (!loadedData.config || !loadedData.version) {
                        showNotification('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·é€‰æ‹©æ­£ç¡®çš„æ•°æ®æ–‡ä»¶ï¼', 'warning');
                        return;
                    }
                    
                    // æ¢å¤æ‰€æœ‰æ•°æ®
                    config = loadedData.config;
                    dailyRecords = loadedData.dailyRecords || [];
                    totalScore = loadedData.totalScore || 0;
                    completedDays = loadedData.completedDays || 0;
                    streakDays = loadedData.streakDays || 0;
                    achievements = loadedData.achievements || {};
                    currentDate = loadedData.currentDate || new Date().toISOString().split('T')[0];
                    dailyScore = loadedData.dailyScore || 0;
                    
                    // æ›´æ–°ç•Œé¢
                    updatePlanTitle();
                    if (config.theme) {
                        setTheme(config.theme);
                    }
                    
                    // åˆå§‹åŒ–ç•Œé¢
                    if (config.setupComplete) {
                        showMainApp();
                        loadStoredSetupData();
                        initializeDatePicker();
                        renderCheckinTasks();
                        loadDateData();
                        updateDisplay();
                        renderRewardTable();
                        initializeDefaultTab();
                    } else {
                        initializeSetup();
                        showTab(null, 'guide');
                    }
                    
                    showNotification(`æ•°æ®åŠ è½½æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ${config.studentName || 'åŒå­¦'}ï¼`, 'success');
                    
                } catch (error) {
                    console.error('æ•°æ®åŠ è½½å¤±è´¥:', error);
                    showNotification('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œæ— æ³•åŠ è½½æ•°æ®ï¼', 'warning');
                }
            };
            reader.readAsText(file);
            
            // æ¸…ç©ºæ–‡ä»¶è¾“å…¥ï¼Œå…è®¸é‡å¤é€‰æ‹©åŒä¸€æ–‡ä»¶
            input.value = '';
        }

        // æ˜¾ç¤ºä¿å­˜æŒ‡ç¤ºå™¨
        function showSaveIndicator() {
            const indicator = document.getElementById('auto-save-indicator');
            if (indicator) {
                indicator.classList.add('show');
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 3000);
            }
        }

        // ç”ŸæˆéšæœºéªŒè¯ç 
        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNPQRSTUVWXYZ123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // æ˜¾ç¤ºéªŒè¯ç å¼¹çª—
        function showVerificationModal() {
            currentVerificationCode = generateVerificationCode();
            document.getElementById('verification-code').textContent = currentVerificationCode;
            document.getElementById('verification-input').value = '';
            document.getElementById('verification-modal').style.display = 'flex';
            document.getElementById('verification-input').focus();
        }

        // å…³é—­éªŒè¯ç å¼¹çª—
        function closeVerificationModal() {
            document.getElementById('verification-modal').style.display = 'none';
            currentVerificationCode = '';
        }

        // ç¡®è®¤é‡ç½®
        function confirmReset() {
            const inputCode = document.getElementById('verification-input').value.toUpperCase();
            if (inputCode === currentVerificationCode) {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                    resetAllData();
                    closeVerificationModal();
                }
            } else {
                showNotification('éªŒè¯ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼', 'warning');
                document.getElementById('verification-input').value = '';
                document.getElementById('verification-input').focus();
            }
        }

        // é‡ç½®æ‰€æœ‰æ•°æ®
        function resetAllData() {
            config = {
                studentName: '',
                studentGrade: '',
                planName: 'æš‘å‡å­¦ä¹ æˆé•¿è®¡åˆ’',
                vacationStart: '',
                vacationEnd: '',
                dailyTarget: 35,
                finalTarget: 1200,
                studyTasks: [],
                lifeHabits: [],
                rewardItems: [],
                setupComplete: false,
                theme: 'spring'
            };
            
            dailyScore = 0;
            totalScore = 0;
            completedDays = 0;
            streakDays = 0;
            dailyRecords = [];
            achievements = {};
            
            showNotification('æ‰€æœ‰æ•°æ®å·²é‡ç½®ï¼Œå³å°†åˆ·æ–°é¡µé¢', 'success');
            setTimeout(() => location.reload(), 1000);
        }

        // é”®ç›˜äº‹ä»¶ç›‘å¬
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && document.getElementById('verification-modal').style.display === 'flex') {
                confirmReset();
            }
        });

        // é€šçŸ¥ç³»ç»Ÿ
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // ä¸»é¢˜ç³»ç»Ÿ
        function setTheme(themeName) {
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelector(`.theme-btn.${themeName}`).classList.add('active');
            
            config.theme = themeName;
            document.body.setAttribute('data-theme', themeName);
            showNotification(`å·²åˆ‡æ¢ä¸»é¢˜`, 'success');
        }

        // å¥–åŠ±ç³»ç»Ÿ
        function checkAndShowRewards() {
            config.rewardItems.forEach(item => {
                const achievementKey = `${item.name}_${item.target}`;
                
                let shouldShow = false;
                if (item.type === 'daily' && dailyScore >= item.target && !achievements[achievementKey]) {
                    shouldShow = true;
                } else if (item.type === 'total' && totalScore >= item.target && !achievements[achievementKey]) {
                    shouldShow = true;
                }
                
                if (shouldShow) {
                    showRewardAlert(item.name, `æ­å–œï¼ä½ è·å¾—äº†"${item.reward}"ï¼`);
                    achievements[achievementKey] = true;
                }
            });
        }
        
        function showRewardAlert(title, message) {
            const alertEl = document.getElementById('reward-alert');
            const titleEl = document.getElementById('reward-title');
            const messageEl = document.getElementById('reward-message');
            
            if (titleEl) titleEl.textContent = title;
            if (messageEl) messageEl.textContent = message;
            if (alertEl) alertEl.classList.add('show');
            
            setTimeout(() => {
                closeRewardAlert();
            }, 5000);
        }
        
        function closeRewardAlert() {
            const alertEl = document.getElementById('reward-alert');
            if (alertEl) alertEl.classList.remove('show');
        }

        function renderRewardTable() {
            const container = document.getElementById('reward-display');
            if (!container) return;
            
            let tableHTML = `
                <table class="reward-table">
                    <thead>
                        <tr>
                            <th>æ¿€åŠ±åç§°</th>
                            <th>è¾¾æˆæ¡ä»¶</th>
                            <th>æ¿€åŠ±å†…å®¹</th>
                            <th>ç›®æ ‡è¦æ±‚</th>
                            <th>çŠ¶æ€</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            config.rewardItems.forEach((item, index) => {
                let status = 'âŒ æœªè¾¾æˆ';
                if (item.type === 'daily' && dailyScore >= item.target) {
                    status = 'âœ… å·²è¾¾æˆ';
                } else if (item.type === 'total' && totalScore >= item.target) {
                    status = 'âœ… å·²è¾¾æˆ';
                } else if (item.type === 'weekly') {
                    const recentDays = dailyRecords.slice(-7);
                    const weeklyStars = recentDays.filter(day => day.score >= config.dailyTarget).length;
                    status = weeklyStars >= item.target ? 'âœ… å·²è¾¾æˆ' : `âŒ æœ¬å‘¨${weeklyStars}/${item.target}å¤©`;
                }
                
                tableHTML += `
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.condition}</td>
                        <td>${item.reward}</td>
                        <td>${item.target}${item.type === 'daily' ? 'åˆ†/å¤©' : item.type === 'weekly' ? 'å¤©/å‘¨' : 'åˆ†'}</td>
                        <td>${status}</td>
                    </tr>
                `;
            });
            
            tableHTML += `</tbody></table>`;
            container.innerHTML = tableHTML;
        }

        // Evaè€å¸ˆçš„æ™ºèƒ½å»ºè®®ç³»ç»Ÿ
        function generateSuggestions() {
            const container = document.getElementById('study-suggestions');
            if (!container) return;
            
            const suggestion = getLatestEvaAdvice();
            
            container.innerHTML = `
                <div class="eva-message">
                    <div class="eva-title">Evaè€å¸ˆçš„è¯ï¼š</div>
                    <div class="eva-content">${suggestion}</div>
                </div>
            `;
        }

        function getLatestEvaAdvice() {
            const studentName = config.studentName || 'å­©å­';
            
            if (dailyRecords.length === 0) {
                return `${studentName}ï¼Œå¼€å§‹å­¦ä¹ ä¹‹æ—…çš„ç¬¬ä¸€æ­¥æœ€é‡è¦ï¼æ¯å¤©åšæŒä¸€ç‚¹ç‚¹ï¼Œä½ ä¼šçœ‹åˆ°è‡ªå·±çš„è¿›æ­¥ã€‚è®°ä½ï¼Œä¸æ€•æ…¢ï¼Œå°±æ€•åœï¼è®°å¾—ç»å¸¸ä¿å­˜æ•°æ®å“¦ï¼âœ¨`;
            }
            
            const recentDays = dailyRecords.slice(-7);
            const avgScore = recentDays.length > 0 ? recentDays.reduce((sum, day) => sum + day.score, 0) / recentDays.length : 0;
            const progress = (totalScore / config.finalTarget) * 100;
            
            if (streakDays >= 14) {
                return `${studentName}ï¼Œä½ å·²ç»è¿ç»­åšæŒ${streakDays}å¤©äº†ï¼è¿™ç§æ¯…åŠ›è®©è€å¸ˆåˆ®ç›®ç›¸çœ‹ï¼å¥½ä¹ æƒ¯æ­£åœ¨ä½ èº«ä¸Šç”Ÿæ ¹å‘èŠ½ï¼Œç»§ç»­ä¿æŒè¿™ä¸ªè¶…æ£’çš„èŠ‚å¥ï¼ğŸ†`;
            } else if (progress >= 90) {
                return `${studentName}ï¼Œä½ è·ç¦»æœ€ç»ˆç›®æ ‡åªæœ‰ä¸€æ­¥ä¹‹é¥äº†ï¼è¿™ä¸ªå­¦ä¹ è®¡åˆ’çš„åŠªåŠ›å³å°†æ”¶è·æ»¡æ»¡çš„æˆæœã€‚æœ€åçš„å†²åˆºé˜¶æ®µï¼ŒåŠ æ²¹ï¼ğŸš€`;
            } else if (avgScore >= config.dailyTarget * 1.2) {
                return `${studentName}ï¼Œä½ çš„è¡¨ç°è¶…å‡ºäº†é¢„æœŸç›®æ ‡ï¼è¿™ç§ä¼˜ç§€çš„çŠ¶æ€è®©è€å¸ˆä¸ºä½ éª„å‚²ã€‚è¦è®°å¾—åŠ³é€¸ç»“åˆï¼Œä¿æŒèº«å¿ƒå¥åº·å“¦ï¼ğŸ¯`;
            } else if (streakDays >= 7) {
                return `${studentName}ï¼Œè¿ç»­ä¸€å‘¨çš„åšæŒï¼Œä½ å·²ç»è¿ˆè¿‡äº†æœ€éš¾çš„ç¬¬ä¸€å…³ï¼ç°åœ¨è®©æˆ‘ä»¬æŒ‘æˆ˜ä¸¤å‘¨è¿ç»­æ‰“å¡ï¼Œç›¸ä¿¡ä½ ä¸€å®šèƒ½åšåˆ°ï¼ğŸ’ª`;
            } else if (progress >= 75) {
                return `${studentName}ï¼Œä½ å·²ç»å®Œæˆäº†å››åˆ†ä¹‹ä¸‰çš„ç›®æ ‡ï¼çœ‹åˆ°è‡ªå·±è¿™ä¹ˆå¤§çš„è¿›æ­¥ï¼Œæ˜¯ä¸æ˜¯å¾ˆæœ‰æˆå°±æ„Ÿï¼Ÿç»§ç»­ä¿æŒï¼Œèƒœåˆ©å°±åœ¨å‰æ–¹ï¼ğŸŠ`;
            } else if (avgScore >= config.dailyTarget) {
                return `${studentName}ï¼Œä½ çš„è¡¨ç°å¾ˆç¨³å®šï¼Œä¸€ç›´ä¿æŒåœ¨ä¼˜ç§€æ°´å¹³ï¼è¿™ç§ç¨³æ‰ç¨³æ‰“çš„å­¦ä¹ æ–¹å¼æœ€æ£’äº†ã€‚è¯•è¯•çœ‹èƒ½ä¸èƒ½åœ¨æŸäº›æ–¹é¢å†æå‡ä¸€ç‚¹ç‚¹ï¼ŸğŸ“ˆ`;
            } else if (streakDays >= 3) {
                return `${studentName}ï¼Œä¸‰å¤©çš„åšæŒæ˜¯ä¸ªå¾ˆå¥½çš„å¼€å§‹ï¼ç°åœ¨æ˜¯å…»æˆä¹ æƒ¯çš„å…³é”®æœŸï¼Œå†åšæŒ4å¤©å°±èƒ½å®Œæˆä¸€å‘¨æŒ‘æˆ˜å•¦ï¼ğŸŒŸ`;
            } else if (progress >= 50) {
                return `${studentName}ï¼Œæ­å–œä½ å·²ç»å®Œæˆäº†ä¸€åŠçš„ç›®æ ‡ï¼è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„é‡Œç¨‹ç¢‘ã€‚ç°åœ¨ä½ æœ‰ç»éªŒäº†ï¼Œåé¢çš„è·¯ä¼šè¶Šèµ°è¶Šé¡ºçš„ï¼ğŸŒ¸`;
            } else if (avgScore >= config.dailyTarget * 0.8) {
                return `${studentName}ï¼Œä½ å·²ç»åšå¾—å¾ˆä¸é”™äº†ï¼ç¦»ç›®æ ‡åªå·®ä¸€ç‚¹ç‚¹ã€‚è¯•ç€è°ƒæ•´ä¸€ä¸‹å­¦ä¹ æ–¹æ³•ï¼Œæˆ–è€…å‡å°‘ä¸€äº›éš¾åº¦ï¼Œé‡è¦çš„æ˜¯ä¿æŒå­¦ä¹ çš„ä¹è¶£ï¼ğŸˆ`;
            } else {
                const encouragements = [
                    `${studentName}ï¼Œå­¦ä¹ å°±åƒç§èŠ±ä¸€æ ·ï¼Œéœ€è¦è€å¿ƒæµ‡æ°´æ–½è‚¥ï¼Œæ€»æœ‰ä¸€å¤©ä¼šå¼€å‡ºç¾ä¸½çš„èŠ±æœµã€‚ä½ ç°åœ¨åšçš„æ¯ä¸€ä»¶äº‹éƒ½æœ‰æ„ä¹‰ï¼ğŸŒº`,
                    `${studentName}ï¼Œä»Šå¤©çš„ä½ æ¯”æ˜¨å¤©æ›´ä¼˜ç§€ï¼Œæ˜å¤©çš„ä½ ä¼šæ¯”ä»Šå¤©æ›´å‡ºè‰²ï¼æ¯ä¸€å¤©éƒ½æ˜¯æ–°çš„å¯èƒ½ï¼ğŸŒ…`,
                    `${studentName}ï¼Œä¸è¦å°çœ‹æ¯å¤©çš„å°è¿›æ­¥ï¼Œç§¯å°‘æˆå¤šï¼Œä½ ä¼šåˆ›é€ å‡ºè®©è‡ªå·±æƒŠå–œçš„æˆæœï¼åšæŒå°±æ˜¯èƒœåˆ©ï¼ğŸ…`,
                    `${studentName}ï¼Œå­¦ä¹ æ˜¯ä¸€ä¸ªå¾ªåºæ¸è¿›çš„è¿‡ç¨‹ï¼Œä¸è¦å› ä¸ºåˆ†æ•°è€Œæ°”é¦ã€‚è®©æˆ‘ä»¬å…ˆä»å®Œæˆä¸€åŠçš„ä»»åŠ¡å¼€å§‹ï¼Œæ…¢æ…¢æ‰¾å›å­¦ä¹ çš„ä¿¡å¿ƒï¼ğŸŒˆ`
                ];
                return encouragements[Math.floor(Math.random() * encouragements.length)];
            }
        }

        function updateAnalysisData() {
            let bestStreak = 0;
            let currentStreakCount = 0;
            
            dailyRecords.forEach(record => {
                if (record.score >= config.dailyTarget) {
                    currentStreakCount++;
                    bestStreak = Math.max(bestStreak, currentStreakCount);
                } else {
                    currentStreakCount = 0;
                }
            });
            
            const recentWeek = dailyRecords.slice(-7);
            const weeklyAvg = recentWeek.length > 0 ? 
                Math.round(recentWeek.reduce((sum, day) => sum + day.score, 0) / recentWeek.length) : 0;
            
            let studyCompleted = 0;
            let habitCompleted = 0;
            
            dailyRecords.forEach(record => {
                if (record.tasks) {
                    Object.keys(record.tasks).forEach(taskId => {
                        if (record.tasks[taskId]) {
                            if (taskId.startsWith('study-')) {
                                studyCompleted++;
                            } else if (taskId.startsWith('life-')) {
                                habitCompleted++;
                            }
                        }
                    });
                }
            });
            
            const studyCompletion = config.studyTasks.length > 0 && dailyRecords.length > 0 ? 
                Math.round((studyCompleted / (config.studyTasks.length * dailyRecords.length)) * 100) : 0;
            const habitCompletion = config.lifeHabits.length > 0 && dailyRecords.length > 0 ? 
                Math.round((habitCompleted / (config.lifeHabits.length * dailyRecords.length)) * 100) : 0;
            
            updateElementSafe('study-completion', studyCompletion + '%');
            updateElementSafe('habit-completion', habitCompletion + '%');
            updateElementSafe('best-streak', bestStreak);
            updateElementSafe('avg-weekly', weeklyAvg);
        }

        function updateElementSafe(id, value) {
            const element = document.getElementById(id);
            if (element) element.textContent = value;
        }
        
        function initializeDefaultTab() {
            if (config.setupComplete) {
                showTab(null, 'checkin');
            } else {
                showTab(null, 'guide');
            }
        }
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–é»˜è®¤é…ç½®
            initializeSetup();
            
            // è®¾ç½®ä¸»é¢˜
            if (config.theme) {
                setTheme(config.theme);
            }

            updatePlanTitle();
            initializeDefaultTab();
            
            // æ˜¾ç¤ºæ¬¢è¿æç¤º
            setTimeout(() => {
                showNotification('æ¬¢è¿ä½¿ç”¨å­¦ä¹ æˆé•¿è®¡åˆ’ï¼è®°å¾—ç»å¸¸ä¿å­˜æ•°æ®å“¦ï¼', 'success');
            }, 1000);
        });

        function updatePlanTitle() {
            if (config.planName && config.studentName) {
                document.getElementById('plan-title').textContent = `ğŸŒŸ ${config.studentName}çš„${config.planName} ğŸŒŸ`;
            } else if (config.planName) {
                document.getElementById('plan-title').textContent = `ğŸŒŸ ${config.planName} ğŸŒŸ`;
            }

            if (config.vacationStart && config.vacationEnd && config.studentGrade) {
                document.getElementById('plan-subtitle').textContent = `${config.vacationStart} - ${config.vacationEnd} | ${config.studentGrade}`;
            }
        }

        function loadStoredSetupData() {
            if (config.studentName) document.getElementById('student-name').value = config.studentName;
            if (config.studentGrade) document.getElementById('student-grade').value = config.studentGrade;
            if (config.planName) document.getElementById('plan-name').value = config.planName;
            if (config.vacationStart) document.getElementById('vacation-start').value = config.vacationStart;
            if (config.vacationEnd) document.getElementById('vacation-end').value = config.vacationEnd;
            if (config.dailyTarget) document.getElementById('daily-target').value = config.dailyTarget;
            if (config.finalTarget) document.getElementById('final-target').value = config.finalTarget;
        }
        
        function initializeSetup() {
            config.studyTasks = [
                { name: 'è¯­æ–‡å­¦ä¹  (60åˆ†é’Ÿ)', points: 8 },
                { name: 'æ•°å­¦å­¦ä¹  (60åˆ†é’Ÿ)', points: 8 },
                { name: 'è‹±è¯­å­¦ä¹  (45åˆ†é’Ÿ)', points: 8 },
                { name: 'ä½œä¸šå®Œæˆ', points: 5 },
                { name: 'è¯¾å¤–é˜…è¯» (30åˆ†é’Ÿ)', points: 4 }
            ];
            
            config.lifeHabits = [
                { name: 'ä½“è‚²è¿åŠ¨ (60åˆ†é’Ÿ)', points: 5 },
                { name: 'æ¯æ—¥æ€»ç»“åæ€', points: 3 },
                { name: 'å®¶åŠ¡åŠ³åŠ¨', points: 2 },
                { name: 'ä¿è¯8å°æ—¶ç¡çœ ', points: 4 },
                { name: 'è‡ªå®šä¹‰å¥½ä¹ æƒ¯', points: 3 }
            ];

            config.rewardItems = [
                { name: 'ğŸŒŸ æ¯æ—¥ä¹‹æ˜Ÿ', condition: 'å•æ—¥ç§¯åˆ†â‰¥35åˆ†', reward: 'å°é›¶é£Ÿ æˆ– å¨±ä¹æ—¶é—´30åˆ†é’Ÿ', target: 35, type: 'daily' },
                { name: 'ğŸ… å‘¨å† å†›', condition: 'ä¸€å‘¨5å¤©è¾¾åˆ°æ¯æ—¥ä¹‹æ˜Ÿ', reward: 'é€‰æ‹©ä¸€æœ¬ä¹¦ç± æˆ– å°ç©å…·', target: 5, type: 'weekly' },
                { name: 'ğŸ¯ é˜¶æ®µæ¿€åŠ±', condition: 'ç´¯è®¡600åˆ† (åŠç¨‹)', reward: 'å¤–å‡ºæ¸¸ç© æˆ– ç‰¹æ®Šæ´»åŠ¨', target: 600, type: 'total' },
                { name: 'ğŸ‘‘ ç»ˆææˆå°±', condition: 'ç´¯è®¡1200åˆ†', reward: 'ğŸ® å¿ƒä»ªçš„å¥–å“', target: 1200, type: 'total' },
                { name: 'ğŸ’ è¶…çº§æˆå°±', condition: 'ç´¯è®¡1500åˆ†', reward: 'é¢å¤–å¥–å“ + ç‰¹åˆ«æ¿€åŠ±', target: 1500, type: 'total' }
            ];
            
            renderSetupForms();
        }
        
        function renderSetupForms() {
            renderStudyTasks();
            renderLifeHabits();
            renderRewardItems();
        }
        
        function renderStudyTasks() {
            const container = document.getElementById('study-tasks');
            if (!container) return;
            
            container.innerHTML = '';
            
            config.studyTasks.forEach((task, index) => {
                const taskDiv = document.createElement('div');
                taskDiv.className = 'task-config-item';
                taskDiv.innerHTML = `
                    <input type="text" value="${task.name}" onchange="updateStudyTask(${index}, 'name', this.value)" placeholder="ä»»åŠ¡åç§°">
                    <input type="number" value="${task.points}" min="1" max="20" onchange="updateStudyTask(${index}, 'points', this.value)" title="ç§¯åˆ†">
                    <span>åˆ†</span>
                    <button onclick="removeStudyTask(${index})">åˆ é™¤</button>
                `;
                container.appendChild(taskDiv);
            });
        }
        
        function renderLifeHabits() {
            const container = document.getElementById('life-habits');
            if (!container) return;
            
            container.innerHTML = '';
            
            config.lifeHabits.forEach((habit, index) => {
                const habitDiv = document.createElement('div');
                habitDiv.className = 'task-config-item';
                habitDiv.innerHTML = `
                    <input type="text" value="${habit.name}" onchange="updateLifeHabit(${index}, 'name', this.value)" placeholder="ä¹ æƒ¯åç§°">
                    <input type="number" value="${habit.points}" min="1" max="20" onchange="updateLifeHabit(${index}, 'points', this.value)" title="ç§¯åˆ†">
                    <span>åˆ†</span>
                    <button onclick="removeLifeHabit(${index})">åˆ é™¤</button>
                `;
                container.appendChild(habitDiv);
            });
        }

        function renderRewardItems() {
            const container = document.getElementById('reward-items');
            if (!container) return;
            
            container.innerHTML = '';
            
            config.rewardItems.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'reward-config-item';
                itemDiv.innerHTML = `
                    <input type="text" value="${item.name}" onchange="updateRewardItem(${index}, 'name', this.value)" placeholder="æ¿€åŠ±åç§°">
                    <input type="text" value="${item.condition}" onchange="updateRewardItem(${index}, 'condition', this.value)" placeholder="è¾¾æˆæ¡ä»¶">
                    <input type="text" value="${item.reward}" onchange="updateRewardItem(${index}, 'reward', this.value)" placeholder="æ¿€åŠ±å†…å®¹">
                    <input type="number" value="${item.target}" min="1" onchange="updateRewardItem(${index}, 'target', this.value)" placeholder="ç›®æ ‡åˆ†æ•°">
                    <select onchange="updateRewardItem(${index}, 'type', this.value)">
                        <option value="daily" ${item.type === 'daily' ? 'selected' : ''}>æ¯æ—¥</option>
                        <option value="weekly" ${item.type === 'weekly' ? 'selected' : ''}>æ¯å‘¨</option>
                        <option value="total" ${item.type === 'total' ? 'selected' : ''}>ç´¯è®¡</option>
                    </select>
                    <button onclick="removeRewardItem(${index})">åˆ é™¤</button>
                `;
                container.appendChild(itemDiv);
            });
        }
        
        function addStudyTask() {
            config.studyTasks.push({ name: 'æ–°ä»»åŠ¡', points: 5 });
            renderStudyTasks();
        }
        
        function addLifeHabit() {
            config.lifeHabits.push({ name: 'æ–°ä¹ æƒ¯', points: 3 });
            renderLifeHabits();
        }

        function addRewardItem() {
            config.rewardItems.push({ 
                name: 'æ–°æ¿€åŠ±', 
                condition: 'æ¡ä»¶', 
                reward: 'æ¿€åŠ±å†…å®¹', 
                target: 100, 
                type: 'total' 
            });
            renderRewardItems();
        }
        
        function updateStudyTask(index, field, value) {
            if (field === 'points') {
                value = parseInt(value) || 1;
            }
            config.studyTasks[index][field] = value;
        }
        
        function updateLifeHabit(index, field, value) {
            if (field === 'points') {
                value = parseInt(value) || 1;
            }
            config.lifeHabits[index][field] = value;
        }

        function updateRewardItem(index, field, value) {
            if (field === 'target') {
                value = parseInt(value) || 1;
            }
            config.rewardItems[index][field] = value;
        }
        
        function removeStudyTask(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­¦ä¹ ä»»åŠ¡å—ï¼Ÿ')) {
                config.studyTasks.splice(index, 1);
                renderStudyTasks();
            }
        }
        
        function removeLifeHabit(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç”Ÿæ´»ä¹ æƒ¯å—ï¼Ÿ')) {
                config.lifeHabits.splice(index, 1);
                renderLifeHabits();
            }
        }

        function removeRewardItem(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¿€åŠ±é¡¹ç›®å—ï¼Ÿ')) {
                config.rewardItems.splice(index, 1);
                renderRewardItems();
            }
        }
        
        function saveSetup() {
            config.studentName = document.getElementById('student-name').value.trim();
            config.studentGrade = document.getElementById('student-grade').value;
            config.planName = document.getElementById('plan-name').value.trim() || 'å­¦ä¹ æˆé•¿è®¡åˆ’';
            config.vacationStart = document.getElementById('vacation-start').value;
            config.vacationEnd = document.getElementById('vacation-end').value;
            config.dailyTarget = parseInt(document.getElementById('daily-target').value) || 35;
            config.finalTarget = parseInt(document.getElementById('final-target').value) || 1200;
            
            if (!config.studentName) {
                showNotification('è¯·è¾“å…¥å­©å­çš„å§“åï¼', 'warning');
                return;
            }
            
            if (!config.studentGrade) {
                showNotification('è¯·é€‰æ‹©å¹´çº§ï¼', 'warning');
                return;
            }
            
            if (!config.vacationStart || !config.vacationEnd) {
                showNotification('è¯·é€‰æ‹©è®¡åˆ’çš„å¼€å§‹å’Œç»“æŸæ—¥æœŸï¼', 'warning');
                return;
            }
            
            if (new Date(config.vacationStart) >= new Date(config.vacationEnd)) {
                showNotification('ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸï¼', 'warning');
                return;
            }
            
            if (config.studyTasks.length === 0) {
                showNotification('è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªå­¦ä¹ ä»»åŠ¡ï¼', 'warning');
                return;
            }
            
            if (config.lifeHabits.length === 0) {
                showNotification('è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªç”Ÿæ´»ä¹ æƒ¯ï¼', 'warning');
                return;
            }
            
            config.setupComplete = true;
            
            updatePlanTitle();
            
            showNotification('è®¾ç½®ä¿å­˜æˆåŠŸï¼åˆ«å¿˜äº†ç‚¹å‡»"ä¸€é”®ä¿å­˜"ä¿å­˜æ•°æ®å“¦ï¼', 'success');
            
            const setupSection = document.querySelector('#setup');
            setupSection.innerHTML = `
                <div class="setup-complete">
                    âœ… ä¸ªäººè®¾ç½®å·²å®Œæˆï¼å¦‚éœ€ä¿®æ”¹è®¾ç½®ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ã€‚
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="editSetup()">ä¿®æ”¹è®¾ç½®</button>
                </div>
            `;
            
            setTimeout(() => {
                showMainApp();
                initializeDatePicker();
                renderCheckinTasks();
                renderRewardTable();
            }, 1000);
        }

        function editSetup() {
            config.setupComplete = false;
            
            const setupSection = document.querySelector('#setup');
            setupSection.innerHTML = `
                <div class="section">
                    <h2>âš™ï¸ ä¸ªäººä¿¡æ¯è®¾ç½®</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="student-name">å­©å­å§“åï¼š</label>
                            <input type="text" id="student-name" placeholder="è¯·è¾“å…¥å§“å">
                        </div>
                        <div class="form-group">
                            <label for="student-grade">å¹´çº§ï¼š</label>
                            <select id="student-grade">
                                <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                                <option value="ä¸€å¹´çº§">ä¸€å¹´çº§</option>
                                <option value="äºŒå¹´çº§">äºŒå¹´çº§</option>
                                <option value="ä¸‰å¹´çº§">ä¸‰å¹´çº§</option>
                                <option value="å››å¹´çº§">å››å¹´çº§</option>
                                <option value="äº”å¹´çº§">äº”å¹´çº§</option>
                                <option value="å…­å¹´çº§">å…­å¹´çº§</option>
                                <option value="åˆä¸€">åˆä¸€</option>
                                <option value="åˆäºŒ">åˆäºŒ</option>
                                <option value="åˆä¸‰">åˆä¸‰</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="plan-name">è®¡åˆ’åç§°ï¼š</label>
                        <input type="text" id="plan-name" placeholder="å¦‚ï¼šæš‘å‡å­¦ä¹ è®¡åˆ’ã€æœŸæœ«å†²åˆºè®¡åˆ’ç­‰" value="æš‘å‡å­¦ä¹ æˆé•¿è®¡åˆ’">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="vacation-start">è®¡åˆ’å¼€å§‹æ—¥æœŸï¼š</label>
                            <input type="date" id="vacation-start">
                        </div>
                        <div class="form-group">
                            <label for="vacation-end">è®¡åˆ’ç»“æŸæ—¥æœŸï¼š</label>
                            <input type="date" id="vacation-end">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="daily-target">æ¯æ—¥ä¼˜ç§€æ ‡å‡†åˆ†æ•°ï¼š</label>
                            <input type="number" id="daily-target" min="20" max="100" value="35" placeholder="35">
                        </div>
                        <div class="form-group">
                            <label for="final-target">æœ€ç»ˆç›®æ ‡æ€»åˆ†ï¼š</label>
                            <input type="number" id="final-target" min="500" max="5000" value="1200" placeholder="1200">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>ğŸ“š å­¦ä¹ ä»»åŠ¡è®¾ç½®</h2>
                    <div id="study-tasks"></div>
                    <button class="btn btn-secondary" onclick="addStudyTask()">+ æ·»åŠ å­¦ä¹ ä»»åŠ¡</button>
                </div>
                
                <div class="section">
                    <h2>ğŸ’ª ç”Ÿæ´»ä¹ æƒ¯è®¾ç½®</h2>
                    <div id="life-habits"></div>
                    <button class="btn btn-secondary" onclick="addLifeHabit()">+ æ·»åŠ ç”Ÿæ´»ä¹ æƒ¯</button>
                </div>

                <div class="section">
                    <h2>ğŸ† æˆé•¿æ¿€åŠ±è®¾ç½®</h2>
                    <div id="reward-items"></div>
                    <button class="btn btn-secondary" onclick="addRewardItem()">+ æ·»åŠ æ¿€åŠ±é¡¹ç›®</button>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-success" onclick="saveSetup()" style="font-size: 1.3em; padding: 18px 35px;">
                        âœ… ä¿å­˜è®¾ç½®å¹¶å¼€å§‹ä½¿ç”¨
                    </button>
                </div>
            `;
            
            initializeSetup();
            loadStoredSetupData();
            showNotification('å·²è¿›å…¥ä¿®æ”¹æ¨¡å¼ï¼Œå¯ä»¥ä¿®æ”¹æ‰€æœ‰è®¾ç½®', 'success');
        }
        
        function showMainApp() {
            document.getElementById('checkin-tab').style.display = 'block';
            document.getElementById('records-tab').style.display = 'block';
            document.getElementById('analysis-tab').style.display = 'block';
            document.getElementById('rewards-tab').style.display = 'block';
            document.getElementById('backup-tab').style.display = 'block';
            
            updatePlanTitle();
            showTab(null, 'checkin');
        }
        
        function renderCheckinTasks() {
            const studyContainer = document.getElementById('study-checkin');
            const lifeContainer = document.getElementById('life-checkin');
            
            if (!studyContainer || !lifeContainer) {
                return;
            }
            
            studyContainer.innerHTML = '';
            lifeContainer.innerHTML = '';
            
            if (config.studyTasks.length === 0 && config.lifeHabits.length === 0) {
                studyContainer.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">è¯·å…ˆåœ¨ä¸ªäººè®¾ç½®ä¸­æ·»åŠ å­¦ä¹ ä»»åŠ¡</div>';
                lifeContainer.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">è¯·å…ˆåœ¨ä¸ªäººè®¾ç½®ä¸­æ·»åŠ ç”Ÿæ´»ä¹ æƒ¯</div>';
                return;
            }
            
            config.studyTasks.forEach((task, index) => {
                const taskDiv = document.createElement('div');
                taskDiv.className = 'task-item';
                taskDiv.dataset.points = task.points;
                taskDiv.innerHTML = `
                    <input type="checkbox" class="task-checkbox" id="study-${index}" onchange="onTaskChange()">
                    <span class="task-name">${task.name}</span>
                    <span class="task-points">${task.points}åˆ†</span>
                `;
                studyContainer.appendChild(taskDiv);
            });
            
            config.lifeHabits.forEach((habit, index) => {
                const habitDiv = document.createElement('div');
                habitDiv.className = 'task-item';
                habitDiv.dataset.points = habit.points;
                habitDiv.innerHTML = `
                    <input type="checkbox" class="task-checkbox" id="life-${index}" onchange="onTaskChange()">
                    <span class="task-name">${habit.name}</span>
                    <span class="task-points">${habit.points}åˆ†</span>
                `;
                lifeContainer.appendChild(habitDiv);
            });
            
            const maxScore = [...config.studyTasks, ...config.lifeHabits].reduce((sum, item) => sum + item.points, 0);
            const maxScoreEl = document.getElementById('max-score');
            if (maxScoreEl) {
                maxScoreEl.textContent = maxScore;
            }
        }

        function onTaskChange() {
            const checkbox = event.target;
            const taskItem = checkbox.parentElement;
            
            if (checkbox.checked) {
                taskItem.classList.add('completed');
            } else {
                taskItem.classList.remove('completed');
            }
            
            calculateDailyScore();
            updateDisplay();
        }
        
        function initializeDatePicker() {
            const dateInput = document.getElementById('check-date');
            if (!dateInput) return;
            
            if (config.vacationStart && config.vacationEnd) {
                dateInput.min = config.vacationStart;
                dateInput.max = config.vacationEnd;
            } else {
                dateInput.removeAttribute('min');
                dateInput.removeAttribute('max');
            }
            
            if (config.vacationStart && config.vacationEnd) {
                const currentDateObj = new Date(currentDate);
                const startDateObj = new Date(config.vacationStart);
                const endDateObj = new Date(config.vacationEnd);
                
                if (currentDateObj < startDateObj) {
                    currentDate = config.vacationStart;
                } else if (currentDateObj > endDateObj) {
                    currentDate = config.vacationEnd;
                }
            }
            
            dateInput.value = currentDate;
            dateInput.removeEventListener('change', handleDateChange);
            dateInput.addEventListener('change', handleDateChange);
            updateDateDisplay();
        }
        
        function handleDateChange(event) {
            currentDate = event.target.value;
            updateDateDisplay();
            loadDateData();
        }
        
        function updateDateDisplay() {
            const selectedDate = new Date(currentDate);
            const today = new Date();
            const dateDisplay = document.getElementById('current-date-display');
            const dateGoal = document.getElementById('date-goal');
            
            if (!dateDisplay || !dateGoal) return;
            
            if (currentDate === today.toISOString().split('T')[0]) {
                dateDisplay.textContent = 'ä»Šå¤©';
                dateGoal.textContent = 'ä»Šæ—¥ç›®æ ‡ï¼š';
            } else if (selectedDate < today) {
                dateDisplay.textContent = `è¡¥æ‰“å¡ - ${selectedDate.toLocaleDateString('zh-CN')}`;
                dateGoal.textContent = 'è¡¥æ‰“å¡ç›®æ ‡ï¼š';
            } else {
                dateDisplay.textContent = `æœªæ¥ - ${selectedDate.toLocaleDateString('zh-CN')}`;
                dateGoal.textContent = 'æœªæ¥ç›®æ ‡ï¼š';
            }
        }
        
        function setToday() {
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('check-date');
            if (dateInput) dateInput.value = today;
            currentDate = today;
            updateDateDisplay();
            loadDateData();
        }
        
        function loadDateData() {
            const dateRecord = dailyRecords.find(record => record.date === currentDate);
            
            const checkboxes = document.querySelectorAll('.task-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
                checkbox.parentElement.classList.remove('completed');
            });
            
            if (dateRecord && dateRecord.tasks) {
                Object.keys(dateRecord.tasks).forEach(taskId => {
                    const checkbox = document.getElementById(taskId);
                    if (checkbox && dateRecord.tasks[taskId]) {
                        checkbox.checked = true;
                        checkbox.parentElement.classList.add('completed');
                    }
                });
            }
            
            calculateDailyScore();
            updateDisplay();
        }
        
        function calculateDailyScore() {
            dailyScore = 0;
            const checkboxes = document.querySelectorAll('.task-checkbox:checked');
            checkboxes.forEach(checkbox => {
                const points = parseInt(checkbox.parentElement.dataset.points) || 0;
                dailyScore += points;
            });
        }
        
        function updateDisplay() {
            updateElementSafe('daily-score', dailyScore);
            updateElementSafe('total-score', totalScore);
            updateElementSafe('completed-days', completedDays);
            updateElementSafe('average-score', completedDays > 0 ? Math.round(totalScore / completedDays) : 0);
            updateElementSafe('streak-days', streakDays);
            updateElementSafe('target-progress', Math.round((totalScore / config.finalTarget) * 100) + '%');
            
            const maxScore = parseInt(document.getElementById('max-score')?.textContent || '50');
            const progressPercent = maxScore > 0 ? (dailyScore / maxScore) * 100 : 0;
            const circumference = 2 * Math.PI * 55;
            const progressOffset = circumference - (progressPercent / 100) * circumference;
            const progressCircle = document.getElementById('progress-circle');
            if (progressCircle) {
                progressCircle.style.strokeDasharray = circumference;
                progressCircle.style.strokeDashoffset = progressOffset;
            }
            
            updateStats();
        }
        
        function updateStats() {
            if (!config.vacationStart || !config.vacationEnd) return;
            
            const vacationStart = new Date(config.vacationStart);
            const vacationEnd = new Date(config.vacationEnd);
            const today = new Date();
            const totalDays = Math.ceil((vacationEnd - vacationStart) / (1000 * 60 * 60 * 24)) + 1;
            const remainingDays = Math.max(0, Math.ceil((vacationEnd - today) / (1000 * 60 * 60 * 24)));
            const completionRate = totalDays > 0 ? Math.round((completedDays / totalDays) * 100) : 0;
            const avgScore = completedDays > 0 ? Math.round(totalScore / completedDays) : 0;
            const predictedTotal = avgScore * totalDays;
            
            updateElementSafe('total-days', totalDays);
            updateElementSafe('remaining-days', remainingDays);
            updateElementSafe('completion-rate', completionRate + '%');
            updateElementSafe('predicted-total', predictedTotal);
        }
        
        function updateRecords() {
            const recordsList = document.getElementById('records-list');
            if (!recordsList) return;
            
            recordsList.innerHTML = '';
            
            if (dailyRecords.length === 0) {
                recordsList.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">è¿˜æ²¡æœ‰è®°å½•ï¼Œå¼€å§‹ä½ çš„ç¬¬ä¸€å¤©å§ï¼</div>';
                return;
            }
            
            let runningTotal = 0;
            dailyRecords.forEach((record, index) => {
                runningTotal += record.score;
                const recordItem = document.createElement('div');
                recordItem.className = 'record-item';
                
                if (record.date === currentDate) {
                    recordItem.style.background = 'var(--highlight-color)';
                    recordItem.style.fontWeight = 'bold';
                }
                
                recordItem.innerHTML = `
                    <span class="record-date">ç¬¬${index + 1}å¤© - ${record.date}</span>
                    <span class="record-score">${record.score}åˆ†</span>
                    <span style="color: #666; font-size: 0.9em;">ç´¯è®¡: ${runningTotal}åˆ†</span>
                `;
                
                recordItem.addEventListener('click', () => {
                    currentDate = record.date;
                    const dateInput = document.getElementById('check-date');
                    if (dateInput) dateInput.value = currentDate;
                    updateDateDisplay();
                    loadDateData();
                    showTab(null, 'checkin');
                });
                
                recordsList.appendChild(recordItem);
            });
        }
        
        function saveProgress() {
            const selectedDate = new Date(currentDate);
            const today = new Date();
            
            if (selectedDate > today) {
                showNotification('ä¸èƒ½ä¸ºæœªæ¥æ—¥æœŸä¿å­˜è¿›åº¦å“¦ï¼', 'warning');
                return;
            }
            
            if (dailyScore < config.dailyTarget) {
                showNotification(`å¾—åˆ†ä¸è¶³${config.dailyTarget}åˆ†ï¼Œæ— æ³•ä¿å­˜ä¸ºå®Œæˆæ—¥ã€‚å½“å‰ï¼š${dailyScore}åˆ†`, 'warning');
                return;
            }
            
            const tasks = {};
            const checkboxes = document.querySelectorAll('.task-checkbox');
            checkboxes.forEach(checkbox => {
                tasks[checkbox.id] = checkbox.checked;
            });
            
            const existingRecordIndex = dailyRecords.findIndex(record => record.date === currentDate);
            
            if (existingRecordIndex >= 0) {
                const oldScore = dailyRecords[existingRecordIndex].score;
                dailyRecords[existingRecordIndex] = {
                    date: currentDate,
                    score: dailyScore,
                    tasks: tasks
                };
                totalScore = totalScore - oldScore + dailyScore;
                showNotification('å½“æ—¥è¿›åº¦å·²æ›´æ–°ï¼è®°å¾—ä¿å­˜æ•°æ®å“¦ï¼', 'success');
            } else {
                dailyRecords.push({
                    date: currentDate,
                    score: dailyScore,
                    tasks: tasks
                });
                
                dailyRecords.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                totalScore += dailyScore;
                completedDays++;
                
                const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
                const lastRecord = dailyRecords[dailyRecords.length - 2];
                if (lastRecord && lastRecord.date === yesterday) {
                    streakDays++;
                } else {
                    streakDays = 1;
                }
                
                showNotification(`ğŸ‰ è¿›åº¦å·²ä¿å­˜ï¼æ€»åˆ†ï¼š${totalScore}åˆ† è®°å¾—ä¿å­˜æ•°æ®ï¼`, 'success');
            }
            
            checkAndShowRewards();
            updateDisplay();
            updateRecords();
            renderRewardTable();
        }
        
        function resetDaily() {
            if (confirm('ç¡®å®šè¦é‡ç½®å½“å‰æ—¥æœŸçš„è¿›åº¦å—ï¼Ÿ')) {
                dailyScore = 0;
                const checkboxes = document.querySelectorAll('.task-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                    checkbox.parentElement.classList.remove('completed');
                });
                updateDisplay();
                showNotification('å½“æ—¥è¿›åº¦å·²é‡ç½®', 'success');
            }
        }
        
        function showTab(event, tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const tabButtons = document.querySelectorAll('.nav-tab');
            tabButtons.forEach(button => button.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            
            const targetButton = event ? event.target : document.querySelector(`[onclick*="${tabName}"]`);
            if (targetButton) {
                targetButton.classList.add('active');
            }
            
            if (tabName === 'records') {
                updateRecords();
            } else if (tabName === 'analysis') {
                setTimeout(() => {
                    updateAnalysisData();
                    generateSuggestions();
                }, 100);
            } else if (tabName === 'rewards') {
                renderRewardTable();
            } else if (tabName === 'checkin') {
                setTimeout(() => {
                    renderCheckinTasks();
                    loadDateData();
                }, 100);
            }
        }

        function exportData() {
            const exportData = {
                config: config,
                dailyRecords: dailyRecords,
                totalScore: totalScore,
                completedDays: completedDays,
                streakDays: streakDays,
                achievements: achievements,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å­¦ä¹ è®¡åˆ’å¤‡ä»½_${config.studentName || 'æœªå‘½å'}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('æ•°æ®å¯¼å‡ºæˆåŠŸï¼', 'success');
        }

        function generateReport() {
            const avgScore = completedDays > 0 ? Math.round(totalScore / completedDays) : 0;
            const totalDays = config.vacationStart && config.vacationEnd ? 
                Math.ceil((new Date(config.vacationEnd) - new Date(config.vacationStart)) / (1000 * 60 * 60 * 24)) + 1 : 43;
            const completionRate = Math.round((completedDays / totalDays) * 100);
            
            const report = `
            <!DOCTYPE html>
            <html>
            <head>
                <meta charset="UTF-8">
                <title>${config.studentName}çš„å­¦ä¹ æŠ¥å‘Š</title>
                <style>
                    body { font-family: "Microsoft YaHei", sans-serif; margin: 40px; background: linear-gradient(135deg, #f8fffe, #d3e6d2); color: #2c3e50; font-size: 16px; }
                    .header { text-align: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
                    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 20px 0; }
                    .stat-card { background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
                    .records { margin: 30px 0; background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
                    table { width: 100%; border-collapse: collapse; }
                    th, td { padding: 12px; border: 1px solid #ddd; text-align: center; font-size: 16px; }
                    th { background: linear-gradient(135deg, #7fc97f, #a8dadc); color: white; }
                    .highlight { color: #7fc97f; font-weight: bold; }
                    .signature { text-align: center; margin-top: 30px; padding: 15px; background: rgba(255,255,255,0.8); border-radius: 10px; font-size: 1em; color: #666; }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1 style="color: #7fc97f; font-size: 2.2em;">${config.studentName}çš„${config.planName}æŠ¥å‘Š</h1>
                    <p style="font-size: 1.2em;">${config.vacationStart} è‡³ ${config.vacationEnd} | ${config.studentGrade}</p>
                    <p style="font-size: 1.1em;">æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}</p>
                </div>
                
                <div class="stats">
                    <div class="stat-card">
                        <h3 class="highlight" style="font-size: 2.2em;">${totalScore}</h3>
                        <p style="font-size: 1.1em;">ç´¯è®¡æ€»åˆ†</p>
                    </div>
                    <div class="stat-card">
                        <h3 class="highlight" style="font-size: 2.2em;">${completedDays}</h3>
                        <p style="font-size: 1.1em;">å®Œæˆå¤©æ•°</p>
                    </div>
                    <div class="stat-card">
                        <h3 class="highlight" style="font-size: 2.2em;">${avgScore}</h3>
                        <p style="font-size: 1.1em;">å¹³å‡å¾—åˆ†</p>
                    </div>
                    <div class="stat-card">
                        <h3 class="highlight" style="font-size: 2.2em;">${completionRate}%</h3>
                        <p style="font-size: 1.1em;">å®Œæˆç‡</p>
                    </div>
                </div>
                
                <div class="records">
                    <h2 style="color: #7fc97f; font-size: 1.8em;">è¯¦ç»†è®°å½•</h2>
                    <table>
                        <thead>
                            <tr><th>æ—¥æœŸ</th><th>å¾—åˆ†</th><th>ç´¯è®¡åˆ†æ•°</th><th>æ˜¯å¦è¾¾æ ‡</th></tr>
                        </thead>
                        <tbody>
                            ${dailyRecords.map((record, index) => {
                                const runningTotal = dailyRecords.slice(0, index + 1).reduce((sum, r) => sum + r.score, 0);
                                const isTarget = record.score >= config.dailyTarget;
                                return `<tr>
                                    <td>${record.date}</td>
                                    <td style="color: ${isTarget ? '#7fc97f' : '#ff6b6b'}; font-weight: bold;">${record.score}</td>
                                    <td>${runningTotal}</td>
                                    <td style="color: ${isTarget ? '#7fc97f' : '#ff6b6b'}">${isTarget ? 'âœ…' : 'âŒ'}</td>
                                </tr>`;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="signature">
                    <p>æœ¬æŠ¥å‘Šç”±å­¦ä¹ æˆé•¿è®¡åˆ’ç³»ç»Ÿç”Ÿæˆ</p>
                    <p>Evaè€å¸ˆğŸ‘©â€ğŸ«ä¼´æ­¥è‹±è¯­ æä¾›æŠ€æœ¯æ”¯æŒ</p>
                </div>
            </body>
            </html>
            `;
            
            const blob = new Blob([report], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å­¦ä¹ æŠ¥å‘Š_${config.studentName || 'æœªå‘½å'}_${new Date().toISOString().split('T')[0]}.html`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('å­¦ä¹ æŠ¥å‘Šç”ŸæˆæˆåŠŸï¼', 'success');
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.config || !Array.isArray(importedData.dailyRecords)) {
                        showNotification('å¯¼å…¥çš„æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼', 'warning');
                        return;
                    }
                    
                    if (confirm('å¯¼å…¥æ•°æ®å°†è¦†ç›–ç°æœ‰æ•°æ®ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ')) {
                        config = importedData.config;
                        dailyRecords = importedData.dailyRecords;
                        totalScore = importedData.totalScore || 0;
                        completedDays = importedData.completedDays || 0;
                        streakDays = importedData.streakDays || 0;
                        achievements = importedData.achievements || {};
                        
                        showNotification('æ•°æ®å¯¼å…¥æˆåŠŸï¼', 'success');
                        setTimeout(() => location.reload(), 1000);
                    }
                } catch (error) {
                    showNotification('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼', 'warning');
                }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>
